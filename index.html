<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rod Selection</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Poppins:wght@500;600&family=Inter:wght@400;500&display=swap" rel="stylesheet">

<style>
:root{
    --navy:#0b1f3a;
    --navy-accent:#1f3c88;
    --navy-light:#e9eef6;
    --border-soft:#d6dce8;
}

body{
    font-family:'Inter',sans-serif;
    background:linear-gradient(180deg,#f4f7fb,#eef2f8);
    margin:0;
}

.header{
    background:linear-gradient(90deg,var(--navy),#102a4d);
    padding:22px 28px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}
.header h2{
    font-family:'Playfair Display',serif;
    color:#fff;
    font-size:36px;
    margin:0;
}
.logo{height:80px}

.page{padding:20px}

.controls{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:10px;
}
.controls input{
    width:260px;
    padding:8px 12px;
    border-radius:8px;
    border:1px solid var(--border-soft);
}
button{
    background:var(--navy-accent);
    color:#fff;
    border:none;
    border-radius:8px;
    padding:8px 16px;
    font-size:13px;
    cursor:pointer;
}

#loading{
    background:var(--navy-light);
    border-radius:6px;
    margin-bottom:8px;
}
#loadingBar{
    height:18px;
    background:var(--navy-accent);
    color:#fff;
    font-size:11px;
    text-align:center;
}

#filters{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:16px;
    margin-bottom:18px;
}
#filters.hidden{display:none}

.filter-column{display:grid;gap:14px}

.filter-box{
    background:#fff;
    border:1px solid var(--border-soft);
    border-radius:12px;
    overflow:hidden;
    display:flex;
    flex-direction:column;
}

.filter-header{
    padding:10px 12px;
    display:flex;
    justify-content:space-between;
    font-weight:600;
    cursor:pointer;
    border-bottom:1px solid var(--border-soft);
}

.toggle{
    font-size:18px;
    transition:transform .2s ease;
}
.filter-box.collapsed .toggle{
    transform:rotate(-90deg);
}

.checkbox-group{
    padding:8px;
    display:grid;
    grid-template-columns:repeat(2,1fr);
    gap:6px;
    overflow-y:auto;
    max-height:150px;
}

.filter-box.collapsed .checkbox-group{
    display:none;
}

.checkbox-group label{
    font-size:12.5px;
    display:flex;
    align-items:center;
}
.checkbox-group input{
    appearance:none;
    width:15px;
    height:15px;
    border:2px solid var(--navy-accent);
    border-radius:50%;
    margin-right:6px;
}
.checkbox-group input:checked{
    background:var(--navy-accent);
}

.table-wrapper{
    max-height:65vh;
    overflow:auto;
    border-radius:12px;
}
table{
    width:100%;
    border-collapse:collapse;
    background:#fff;
}
th,td{
    padding:8px 10px;
    font-size:13px;
    border-bottom:1px solid var(--border-soft);
    white-space:nowrap;
}
th{
    background:var(--navy-light);
    position:sticky;
    top:0;
    z-index:2;
}

#overlay{
    position:fixed;
    inset:0;
    background:rgba(255,255,255,.75);
    display:none;
    align-items:center;
    justify-content:center;
    font-size:22px;
    font-weight:600;
    color:var(--navy);
}

@media(max-width:900px){
    #filters{grid-template-columns:1fr}
    .checkbox-group{grid-template-columns:1fr}
}@media(max-width:600px){

  /* Stack controls vertically */
  .controls{
    flex-direction:column;
    align-items:stretch;
    gap:10px;
  }

  /* Full-width search */
  .controls input{
    width:100%;
    font-size:14px;
  }

  /* Button container fix */
  .controls > div{
    display:flex;
    gap:10px;
  }

  /* Buttons behave nicely */
  .controls button{
    flex:1;
    padding:10px;
    font-size:13px;
    white-space:nowrap;
  }

}
</style>
</head>

<body>

<div class="header">
    <h2>Rod Selection</h2>
    <img src="https://raw.githubusercontent.com/MeefahOnline/Rod-Database/main/Company%20Logo.jpg" class="logo">
</div>

<div class="page">

<div class="controls">
    <input id="searchBox" placeholder="Search rods..." oninput="renderTable()">
    <div>
       <button id="filterToggleBtn" onclick="toggleFilters()">Show Filters</button>
        <button onclick="clearFilters()">Clear All Filters</button>
    </div>
</div>

<div id="loading"><div id="loadingBar">Loading...</div></div>

<div id="filters" class="hidden">
    <div class="filter-column" id="col1"></div>
    <div class="filter-column" id="col2"></div>
</div>

<div class="table-wrapper">
<table>
<thead><tr id="tableHeader"></tr></thead>
<tbody id="tableBody"></tbody>
</table>
</div>

</div>

<div id="overlay">Filtering...</div>

<script>
const jsonURL="https://raw.githubusercontent.com/MeefahOnline/Rod-Database/main/Rod%20Data.json";

const factors=[
 {name:"Brand"},{name:"Type"},{name:"Reel Type"},{name:"Length"},
 {name:"Joint Type"},{name:"Power"},{name:"Action"},
 {name:"Material"},{name:"Ring"},{name:"Reel Seat"},{name:"Warranty"}
];

const filterColumns=[1,3,4,5,6,8,10,11,12,13,18];
let tableData=[],filtersHidden=true;

fetch(jsonURL).then(r=>r.json()).then(data=>{
 tableData=data;
 loading.style.display="none";
 tableHeader.innerHTML=Object.keys(data[0]).map(h=>`<th>${h}</th>`).join("");

 factors.forEach((f,i)=>{
  const values=new Set();
  data.forEach(r=>{
    const v=r[Object.keys(r)[filterColumns[i]]];
    if(v && v!=="0") values.add(v);
  });

  const box=document.createElement("div");
  box.className="filter-box collapsed";
  box.innerHTML=`
    <div class="filter-header">
      <span>${f.name}</span>
      <span class="toggle">▾</span>
    </div>
  `;

  const group=document.createElement("div");
  group.className="checkbox-group";

  [...values].sort().forEach(v=>{
    group.innerHTML+=`
      <label>
        <input type="checkbox" class="filter" data-factor="${f.name}" value="${v}">
        ${v}
      </label>`;
  });

  box.appendChild(group);
  box.querySelector(".filter-header").onclick=()=>box.classList.toggle("collapsed");
  (i<Math.ceil(factors.length/2)?col1:col2).appendChild(box);
 });

 document.querySelectorAll(".filter").forEach(cb=>cb.onchange=renderTable);
 renderTable();
});

function toggleFilters(){
 const f=document.getElementById("filters");
 const btn=event.target;
 filtersHidden=!filtersHidden;
 f.classList.toggle("hidden");
 btn.textContent=filtersHidden?"Show Filters":"Hide Filters";
}

function clearFilters(){
 document.querySelectorAll(".filter").forEach(cb=>cb.checked=false);
 searchBox.value="";
 renderTable();
}

function renderTable(){
 overlay.style.display="flex";
 setTimeout(()=>{
  const search=searchBox.value.toLowerCase();
  const selected={};
  factors.forEach(f=>{
    selected[f.name]=[...document.querySelectorAll(`.filter[data-factor="${f.name}"]:checked`)].map(c=>c.value);
  });

  tableBody.innerHTML="";
  tableData.forEach(r=>{

    // ❌ HIDE ROWS WITH ZERO VALUES
    const hasZero = Object.values(r).some(v => v === 0 || v === "0");
    if(hasZero) return;

    const match=factors.every((f,i)=>{
      if(!selected[f.name].length)return true;
      return selected[f.name].includes(r[Object.keys(r)[filterColumns[i]]]);
    });

    const textMatch=!search || Object.values(r).join(" ").toLowerCase().includes(search);

    if(match && textMatch){
      tableBody.innerHTML+=`
        <tr>
          ${Object.values(r).map(v=>`<td>${v}</td>`).join("")}
        </tr>`;
    }
  });
  overlay.style.display="none";
 },10);
}
</script>

</body>
</html>
